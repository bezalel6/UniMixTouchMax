# Custom JTAG configuration for ESP32-S3 with custom pins
transport select jtag

# Set custom JTAG pins
set ESP32_JTAG_TCK_GPIO 1
set ESP32_JTAG_TDO_GPIO 2  
set ESP32_JTAG_TDI_GPIO 17
set ESP32_JTAG_TMS_GPIO 18

# Include ESP32-S3 target
source [find target/esp32s3.cfg]

# Custom initialization
proc init_custom_jtag {} {
    # Configure GPIO matrix for JTAG
    mww 0x60004000 0x01  # TCK to GPIO1
    mww 0x60004004 0x02  # TDO to GPIO2
    mww 0x60004008 0x11  # TDI to GPIO17
    mww 0x6000400C 0x12  # TMS to GPIO18
}

$_TARGETNAME configure -event reset-init init_custom_jtag
